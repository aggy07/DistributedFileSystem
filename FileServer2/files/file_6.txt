Updated version of file 6